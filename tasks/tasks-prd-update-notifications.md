# Tasks: Update Notifications for Application and Database

Based on PRD: `prd-update-notifications.md`

## Relevant Files

- `backend/src/update_checker.rs` - New module for version parsing, comparison, and update checking logic
- `backend/tests/test_update_checker.rs` - Unit tests for update_checker module
- `backend/src/app_settings.rs` - Add `notify_about_simsapa_updates` and `release_channel` settings
- `backend/src/app_data.rs` - Add getter/setter functions for new settings
- `backend/src/lib.rs` - Register update_checker module
- `backend/Cargo.toml` - Add `reqwest` and `sysinfo` dependencies
- `bridges/src/sutta_bridge.rs` - Add signals, functions, and `updates_checked` flag for update checking
- `bridges/build.rs` - Register UpdateNotificationDialog.qml
- `assets/qml/UpdateNotificationDialog.qml` - New dialog for displaying update notifications
- `assets/qml/SuttaSearchWindow.qml` - Add Timer for delayed update check and Help menu items
- `assets/qml/com/profoundlabs/simsapa/SuttaBridge.qml` - Add qmllint stub functions for update checking

### Notes

- **Testing:** Run `cd backend && cargo test test_update_checker` for Rust tests
- **Build:** Use `make build -B` to rebuild after adding new components
- **All Tests:** Use `make test` to run all tests (Rust + QML + JavaScript)
- The update notification system follows the legacy Python implementation pattern but uses Rust for backend logic
- The API endpoint is `POST https://simsapa.eu.pythonanywhere.com/releases`
- The default release channel is `simsapa-ng` to avoid interference with legacy Python versions

## Tasks

- [ ] 1.0 Backend Core: Create update_checker.rs module with version parsing and comparison
  - [ ] 1.1 Create `backend/src/update_checker.rs` module file with module-level documentation
    - **Priority:** High
    - **Acceptance:** File exists with proper Rust module structure and documentation explaining purpose
    - **Dependencies:** None
    - **PRD Reference:** FR-1
  - [ ] 1.2 Define `Version` struct with `major`, `minor`, `patch`, `alpha` fields (u32, u32, u32, Option<u32>)
    - **Priority:** High
    - **Acceptance:** Struct defined with Debug, Clone, PartialEq, Eq, PartialOrd, Ord derives
    - **Dependencies:** 1.1
    - **PRD Reference:** FR-1
  - [ ] 1.3 Implement `to_version(ver: &str) -> Result<Version>` function to parse version strings
    - **Priority:** High
    - **Acceptance:** Correctly parses formats: "0.1.0", "v0.1.0", "0.1.0-alpha.1", "v0.1.0-alpha.1"; strips 'v' prefix; handles alpha suffix
    - **Dependencies:** 1.2
    - **PRD Reference:** FR-1
  - [ ] 1.4 Implement `compare_versions(a: &Version, b: &Version) -> Ordering` function
    - **Priority:** High
    - **Acceptance:** Compares major, minor, patch, then alpha (None > Some for stable > alpha); returns std::cmp::Ordering
    - **Dependencies:** 1.2
    - **PRD Reference:** FR-1
  - [ ] 1.5 Implement `get_app_version() -> String` function returning current app version
    - **Priority:** High
    - **Acceptance:** Returns version from Cargo.toml via env!("CARGO_PKG_VERSION") or build-time constant
    - **Dependencies:** 1.1
    - **PRD Reference:** FR-2
  - [ ] 1.6 Implement `get_db_version(dbm: &DbManager) -> Option<String>` function
    - **Priority:** High
    - **Acceptance:** Queries appdata database `app_settings` table for 'db_version' key; returns None if not found
    - **Dependencies:** 1.1
    - **PRD Reference:** FR-3
  - [ ] 1.7 Implement `get_release_channel() -> String` function
    - **Priority:** Medium
    - **Acceptance:** Checks RELEASE_CHANNEL env var first, then app settings, defaults to "simsapa-ng"
    - **Dependencies:** 1.1
    - **PRD Reference:** FR-4
  - [ ] 1.8 Implement `is_app_version_compatible_with_db_version(app: &Version, db: &Version) -> bool` function
    - **Priority:** High
    - **Acceptance:** Returns true if major and minor version numbers match; patch/alpha differences are acceptable
    - **Dependencies:** 1.2, 1.3
    - **PRD Reference:** FR-7
  - [ ] 1.9 Add module declaration to `backend/src/lib.rs` to expose `update_checker` module
    - **Priority:** High
    - **Acceptance:** Module is accessible via `simsapa_backend::update_checker`
    - **Dependencies:** 1.1
    - **PRD Reference:** FR-1
  - [ ] 1.10 Verify compilation with `cd backend && cargo build`
    - **Priority:** High
    - **Acceptance:** No compilation errors
    - **Dependencies:** 1.1-1.9

- [ ] 2.0 Backend Core: Implement HTTP client for fetching release information
  - [ ] 2.1 Add `reqwest` dependency to `backend/Cargo.toml` with blocking feature
    - **Priority:** High
    - **Acceptance:** `reqwest = { version = "0.11", features = ["blocking", "json"] }` added to dependencies
    - **Dependencies:** None
    - **PRD Reference:** FR-6
  - [ ] 2.2 Add `sysinfo` dependency to `backend/Cargo.toml` for system information collection
    - **Priority:** Medium
    - **Acceptance:** `sysinfo = "0.30"` added to dependencies (optional, can use std::env for basic info)
    - **Dependencies:** None
    - **PRD Reference:** FR-6
  - [ ] 2.3 Define `ReleasesRequestParams` struct with Serialize derive
    - **Priority:** High
    - **Acceptance:** Struct has fields: channel, app_version, system, machine, cpu_max, cpu_cores, mem_total, screen, no_stats (all String except no_stats: bool)
    - **Dependencies:** 2.1
    - **PRD Reference:** FR-5
  - [ ] 2.4 Define `ReleaseEntry` struct with Deserialize derive
    - **Priority:** High
    - **Acceptance:** Struct has fields: version_tag, github_repo, suttas_lang (Vec<String>), date, title, description
    - **Dependencies:** 2.1
    - **PRD Reference:** FR-5
  - [ ] 2.5 Define `ReleaseSection` struct with `releases: Vec<ReleaseEntry>`
    - **Priority:** High
    - **Acceptance:** Struct has Deserialize derive and releases field
    - **Dependencies:** 2.4
    - **PRD Reference:** FR-5
  - [ ] 2.6 Define `ReleasesInfo` struct with `application` and `assets` fields (ReleaseSection)
    - **Priority:** High
    - **Acceptance:** Struct has Deserialize derive
    - **Dependencies:** 2.5
    - **PRD Reference:** FR-5
  - [ ] 2.7 Define `UpdateInfo` struct for returning update information to QML
    - **Priority:** High
    - **Acceptance:** Struct has Serialize derive with fields: version, message, visit_url, current_version, release_notes, languages (Option<Vec<String>>)
    - **Dependencies:** None
    - **PRD Reference:** Appendix
  - [ ] 2.8 Implement `collect_system_info(screen_size: &str, save_stats: bool) -> ReleasesRequestParams` function
    - **Priority:** Medium
    - **Acceptance:** Collects OS (std::env::consts::OS), arch (std::env::consts::ARCH), CPU cores, memory; respects save_stats flag
    - **Dependencies:** 2.2, 2.3
    - **PRD Reference:** FR-6
  - [ ] 2.9 Implement `fetch_releases_info(screen_size: &str, save_stats: bool) -> Result<ReleasesInfo>` function
    - **Priority:** High
    - **Acceptance:** Makes POST request to https://simsapa.eu.pythonanywhere.com/releases with 30-second timeout; parses JSON response; handles network errors gracefully
    - **Dependencies:** 2.1, 2.3, 2.6, 2.8
    - **PRD Reference:** FR-6
  - [ ] 2.10 Implement `has_app_update(info: &ReleasesInfo, current_version: &str) -> Option<UpdateInfo>` function
    - **Priority:** High
    - **Acceptance:** Gets latest application release from info.application.releases[0]; compares with current app version; returns UpdateInfo with GitHub URL if update available
    - **Dependencies:** 1.3, 1.4, 2.6, 2.7
    - **PRD Reference:** FR-8
  - [ ] 2.11 Implement `get_latest_app_compatible_assets_release(info: &ReleasesInfo, app_version: &Version) -> Option<&ReleaseEntry>` function
    - **Priority:** High
    - **Acceptance:** Filters assets releases by app compatibility (matching major.minor); returns latest compatible release
    - **Dependencies:** 1.3, 1.8, 2.6
    - **PRD Reference:** FR-9
  - [ ] 2.12 Implement `has_db_update(info: &ReleasesInfo, current_app_version: &str, current_db_version: Option<&str>) -> Option<UpdateInfo>` function
    - **Priority:** High
    - **Acceptance:** Gets latest compatible assets release; compares with current db version; returns UpdateInfo if update available
    - **Dependencies:** 2.10, 2.11
    - **PRD Reference:** FR-9
  - [ ] 2.13 Implement `is_local_db_obsolete(app_version: &str, db_version: Option<&str>) -> Option<UpdateInfo>` function
    - **Priority:** High
    - **Acceptance:** Compares app major.minor with db major.minor; returns warning UpdateInfo if db is older
    - **Dependencies:** 1.3, 1.8
    - **PRD Reference:** FR-10
  - [ ] 2.14 Verify compilation with `cd backend && cargo build`
    - **Priority:** High
    - **Acceptance:** No compilation errors
    - **Dependencies:** 2.1-2.13

- [ ] 3.0 App Settings: Add update notification settings to AppSettings
  - [ ] 3.1 Add `notify_about_simsapa_updates: bool` field to `AppSettings` struct in `backend/src/app_settings.rs`
    - **Priority:** High
    - **Acceptance:** Field added with default value `true` in Default impl
    - **Dependencies:** None
    - **PRD Reference:** FR-11
  - [ ] 3.2 Add `release_channel: Option<String>` field to `AppSettings` struct
    - **Priority:** Medium
    - **Acceptance:** Field added with default value `None` (uses "simsapa-ng" when None)
    - **Dependencies:** None
    - **PRD Reference:** FR-11
  - [ ] 3.3 Implement `get_notify_about_simsapa_updates() -> bool` function in AppData
    - **Priority:** High
    - **Acceptance:** Reads from app_settings_cache; returns correct value
    - **Dependencies:** 3.1
    - **PRD Reference:** FR-12
  - [ ] 3.4 Implement `set_notify_about_simsapa_updates(enabled: bool)` function in AppData
    - **Priority:** High
    - **Acceptance:** Updates app_settings_cache and persists to database
    - **Dependencies:** 3.1
    - **PRD Reference:** FR-12
  - [ ] 3.5 Verify settings persist correctly across app restarts
    - **Priority:** High
    - **Acceptance:** Setting value is preserved after closing and reopening app
    - **Dependencies:** 3.3, 3.4

- [ ] 4.0 Bridge Integration: Add update check signals and functions to SuttaBridge
  - [ ] 4.1 Add `updates_checked: bool` field to `SuttaBridgeRust` struct with default `false`
    - **Priority:** High
    - **Acceptance:** Field added to struct and initialized in Default impl
    - **Dependencies:** None
    - **PRD Reference:** FR-13
  - [ ] 4.2 Add `#[qsignal] app_update_available(update_info_json: QString)` signal
    - **Priority:** High
    - **Acceptance:** Signal defined in qobject module with correct cxx_name "appUpdateAvailable"
    - **Dependencies:** None
    - **PRD Reference:** FR-13
  - [ ] 4.3 Add `#[qsignal] db_update_available(update_info_json: QString)` signal
    - **Priority:** High
    - **Acceptance:** Signal defined with correct cxx_name "dbUpdateAvailable"
    - **Dependencies:** None
    - **PRD Reference:** FR-13
  - [ ] 4.4 Add `#[qsignal] local_db_obsolete(update_info_json: QString)` signal
    - **Priority:** High
    - **Acceptance:** Signal defined with correct cxx_name "localDbObsolete"
    - **Dependencies:** None
    - **PRD Reference:** FR-13
  - [ ] 4.5 Add `#[qsignal] no_updates_available()` signal
    - **Priority:** High
    - **Acceptance:** Signal defined with correct cxx_name "noUpdatesAvailable"
    - **Dependencies:** None
    - **PRD Reference:** FR-13
  - [ ] 4.6 Add `#[qsignal] update_check_error(error_message: QString)` signal
    - **Priority:** High
    - **Acceptance:** Signal defined with correct cxx_name "updateCheckError"
    - **Dependencies:** None
    - **PRD Reference:** FR-13
  - [ ] 4.7 Implement `#[qinvokable] check_for_updates(include_no_updates: bool)` function
    - **Priority:** High
    - **Acceptance:** Spawns background thread; performs connectivity check; fetches releases; runs update checks; emits appropriate signals with JSON payloads
    - **Dependencies:** 4.2-4.6, 2.9-2.13
    - **PRD Reference:** FR-14
  - [ ] 4.8 Implement `#[qinvokable] get_updates_checked() -> bool` function
    - **Priority:** High
    - **Acceptance:** Returns current value of updates_checked flag
    - **Dependencies:** 4.1
    - **PRD Reference:** FR-13
  - [ ] 4.9 Implement `#[qinvokable] set_updates_checked(checked: bool)` function
    - **Priority:** High
    - **Acceptance:** Sets updates_checked flag value
    - **Dependencies:** 4.1
    - **PRD Reference:** FR-13
  - [ ] 4.10 Implement `#[qinvokable] get_notify_about_simsapa_updates() -> bool` function
    - **Priority:** High
    - **Acceptance:** Delegates to AppData getter function
    - **Dependencies:** 3.3
    - **PRD Reference:** FR-13
  - [ ] 4.11 Implement `#[qinvokable] set_notify_about_simsapa_updates(enabled: bool)` function
    - **Priority:** High
    - **Acceptance:** Delegates to AppData setter function
    - **Dependencies:** 3.4
    - **PRD Reference:** FR-13
  - [ ] 4.12 Add qmllint stub functions to `assets/qml/com/profoundlabs/simsapa/SuttaBridge.qml`
    - **Priority:** High
    - **Acceptance:** All signals and functions defined with correct signatures for qmllint validation
    - **Dependencies:** 4.2-4.11
    - **PRD Reference:** FR-15
  - [ ] 4.13 Verify compilation with `make build -B`
    - **Priority:** High
    - **Acceptance:** No compilation errors; qmllint passes
    - **Dependencies:** 4.1-4.12

- [ ] 5.0 QML Dialog: Create UpdateNotificationDialog.qml
  - [ ] 5.1 Create `assets/qml/UpdateNotificationDialog.qml` file with basic ApplicationWindow structure
    - **Priority:** High
    - **Acceptance:** File exists with ApplicationWindow, flags: Qt.Dialog, modality: Qt.ApplicationModal
    - **Dependencies:** None
    - **PRD Reference:** FR-16
  - [ ] 5.2 Add properties for dialog configuration: dialog_type, version_info, release_notes, download_url, current_version
    - **Priority:** High
    - **Acceptance:** Properties defined with appropriate types (string); dialog_type can be "app", "db", "obsolete", "no_updates"
    - **Dependencies:** 5.1
    - **PRD Reference:** FR-16
  - [ ] 5.3 Implement `show_app_update(update_info_json: string)` function
    - **Priority:** High
    - **Acceptance:** Parses JSON, sets properties, sets dialog_type to "app", shows dialog
    - **Dependencies:** 5.2
    - **PRD Reference:** FR-17
  - [ ] 5.4 Implement `show_db_update(update_info_json: string)` function
    - **Priority:** High
    - **Acceptance:** Parses JSON, sets properties, sets dialog_type to "db", shows dialog
    - **Dependencies:** 5.2
    - **PRD Reference:** FR-17
  - [ ] 5.5 Implement `show_obsolete_warning(update_info_json: string)` function
    - **Priority:** High
    - **Acceptance:** Parses JSON, sets properties, sets dialog_type to "obsolete", shows dialog
    - **Dependencies:** 5.2
    - **PRD Reference:** FR-17
  - [ ] 5.6 Implement `show_no_updates()` function
    - **Priority:** High
    - **Acceptance:** Sets dialog_type to "no_updates", shows simple "up to date" message
    - **Dependencies:** 5.2
    - **PRD Reference:** FR-17
  - [ ] 5.7 Create app update dialog layout with title, version info, release notes (truncated to 500 chars), Download and Close buttons
    - **Priority:** High
    - **Acceptance:** Layout matches DatabaseValidationDialog style; Download button opens GitHub URL in browser using Qt.openUrlExternally()
    - **Dependencies:** 5.3
    - **PRD Reference:** FR-17
  - [ ] 5.8 Create db update dialog layout with optional update message, language list, Download Now, Later, and Skip This Version buttons
    - **Priority:** High
    - **Acceptance:** Layout consistent with app update; Skip This Version stores skipped version in settings
    - **Dependencies:** 5.4
    - **PRD Reference:** FR-17
  - [ ] 5.9 Create obsolete db warning layout explaining compatibility issue with Download Now and Continue Anyway buttons
    - **Priority:** High
    - **Acceptance:** Warning message clearly explains database needs update; consistent styling
    - **Dependencies:** 5.5
    - **PRD Reference:** FR-17
  - [ ] 5.10 Create no updates dialog layout with simple "up to date" message and OK button
    - **Priority:** High
    - **Acceptance:** Simple, clean layout with confirmation message
    - **Dependencies:** 5.6
    - **PRD Reference:** FR-17
  - [ ] 5.11 Add responsive layout support for mobile (screen width detection, proper margins)
    - **Priority:** Medium
    - **Acceptance:** Dialog displays correctly on Android and desktop; uses is_mobile property pattern
    - **Dependencies:** 5.7-5.10
    - **PRD Reference:** Design Considerations
  - [ ] 5.12 Add theme support using ThemeHelper pattern
    - **Priority:** Medium
    - **Acceptance:** Dialog respects light/dark theme settings
    - **Dependencies:** 5.1
    - **PRD Reference:** Design Considerations

- [ ] 6.0 Window Integration: Add update check Timer and Help menu items to SuttaSearchWindow
  - [ ] 6.1 Add `UpdateNotificationDialog` component instantiation in SuttaSearchWindow.qml
    - **Priority:** High
    - **Acceptance:** Dialog instantiated with id: update_notification_dialog, top_bar_margin bound to root
    - **Dependencies:** 5.1-5.12
    - **PRD Reference:** FR-18
  - [ ] 6.2 Add Timer component for delayed update check (500ms interval, non-repeating)
    - **Priority:** High
    - **Acceptance:** Timer id: update_check_timer; triggers check_for_updates if not already checked and notifications enabled
    - **Dependencies:** 4.7-4.10
    - **PRD Reference:** FR-18
  - [ ] 6.3 Start update_check_timer in Component.onCompleted
    - **Priority:** High
    - **Acceptance:** Timer starts after window initialization
    - **Dependencies:** 6.2
    - **PRD Reference:** FR-18
  - [ ] 6.4 Add Connections block for SuttaBridge update signals
    - **Priority:** High
    - **Acceptance:** Handles onAppUpdateAvailable, onDbUpdateAvailable, onLocalDbObsolete, onNoUpdatesAvailable, onUpdateCheckError
    - **Dependencies:** 4.2-4.6
    - **PRD Reference:** FR-19
  - [ ] 6.5 Implement onAppUpdateAvailable handler to show app update dialog
    - **Priority:** High
    - **Acceptance:** Calls update_notification_dialog.show_app_update(update_info_json)
    - **Dependencies:** 5.3, 6.4
    - **PRD Reference:** FR-19
  - [ ] 6.6 Implement onDbUpdateAvailable handler to show db update dialog
    - **Priority:** High
    - **Acceptance:** Calls update_notification_dialog.show_db_update(update_info_json)
    - **Dependencies:** 5.4, 6.4
    - **PRD Reference:** FR-19
  - [ ] 6.7 Implement onLocalDbObsolete handler to show obsolete warning dialog
    - **Priority:** High
    - **Acceptance:** Calls update_notification_dialog.show_obsolete_warning(update_info_json)
    - **Dependencies:** 5.5, 6.4
    - **PRD Reference:** FR-19
  - [ ] 6.8 Implement onNoUpdatesAvailable handler to show no updates dialog
    - **Priority:** High
    - **Acceptance:** Calls update_notification_dialog.show_no_updates()
    - **Dependencies:** 5.6, 6.4
    - **PRD Reference:** FR-19
  - [ ] 6.9 Implement onUpdateCheckError handler with silent fail on startup, console log
    - **Priority:** Medium
    - **Acceptance:** Logs error to console; does not show error dialog on automatic startup check
    - **Dependencies:** 6.4
    - **PRD Reference:** FR-19
  - [ ] 6.10 Add MenuSeparator before help menu items in help_menu
    - **Priority:** Low
    - **Acceptance:** Visual separator added before update-related menu items
    - **Dependencies:** None
    - **PRD Reference:** FR-20
  - [ ] 6.11 Add "Check for Simsapa Updates..." menu item in help_menu
    - **Priority:** High
    - **Acceptance:** Menu item triggers SuttaBridge.check_for_updates(true) to include "no updates" message
    - **Dependencies:** 4.7
    - **PRD Reference:** FR-20
  - [ ] 6.12 Add "Notify About Simsapa Updates" checkable menu item in help_menu
    - **Priority:** High
    - **Acceptance:** Checkable menu item bound to setting; checked state reflects current setting; onToggled calls set_notify_about_simsapa_updates
    - **Dependencies:** 4.10, 4.11
    - **PRD Reference:** FR-20
  - [ ] 6.13 Initialize notify_about_updates.checked in Component.onCompleted
    - **Priority:** High
    - **Acceptance:** Menu checkbox reflects saved setting on window load
    - **Dependencies:** 6.12
    - **PRD Reference:** FR-21
  - [ ] 6.14 Add MenuSeparator after update items, before About
    - **Priority:** Low
    - **Acceptance:** Visual separator added after update menu items
    - **Dependencies:** 6.11, 6.12
    - **PRD Reference:** FR-20

- [ ] 7.0 Build Configuration and Testing: Register new files and verify complete flow
  - [ ] 7.1 Add `UpdateNotificationDialog.qml` to `bridges/build.rs` qml_files list
    - **Priority:** High
    - **Acceptance:** File path added: `qml_files.push("../assets/qml/UpdateNotificationDialog.qml");`
    - **Dependencies:** 5.1
    - **PRD Reference:** FR-22
  - [ ] 7.2 Create `backend/tests/test_update_checker.rs` test file
    - **Priority:** High
    - **Acceptance:** Test file exists with proper test module structure
    - **Dependencies:** 1.1-1.9, 2.1-2.13
    - **PRD Reference:** FR-23
  - [ ] 7.3 Add test: version parsing for "0.1.0" format
    - **Priority:** High
    - **Acceptance:** Test passes; version correctly parsed as Version { major: 0, minor: 1, patch: 0, alpha: None }
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.4 Add test: version parsing for "v0.1.0" format (with v prefix)
    - **Priority:** High
    - **Acceptance:** Test passes; v prefix stripped correctly
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.5 Add test: version parsing for "0.1.0-alpha.1" format
    - **Priority:** High
    - **Acceptance:** Test passes; alpha field correctly parsed as Some(1)
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.6 Add test: version parsing for "v0.1.0-alpha.2" format
    - **Priority:** High
    - **Acceptance:** Test passes; both v prefix and alpha suffix handled
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.7 Add test: version comparison - higher major version
    - **Priority:** High
    - **Acceptance:** Test passes; v1.0.0 > v0.9.9
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.8 Add test: version comparison - higher minor version
    - **Priority:** High
    - **Acceptance:** Test passes; v0.2.0 > v0.1.9
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.9 Add test: version comparison - stable > alpha
    - **Priority:** High
    - **Acceptance:** Test passes; v0.1.0 > v0.1.0-alpha.1
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.10 Add test: version comparison - alpha ordering
    - **Priority:** High
    - **Acceptance:** Test passes; v0.1.0-alpha.2 > v0.1.0-alpha.1
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.11 Add test: app/db version compatibility - matching major.minor
    - **Priority:** High
    - **Acceptance:** Test passes; v0.1.5 compatible with v0.1.0
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.12 Add test: app/db version compatibility - mismatched minor
    - **Priority:** High
    - **Acceptance:** Test passes; v0.2.0 NOT compatible with v0.1.0
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.13 Add test: has_app_update returns Some when update available
    - **Priority:** High
    - **Acceptance:** Test passes with mock ReleasesInfo; returns correct UpdateInfo
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.14 Add test: has_app_update returns None when current is latest
    - **Priority:** High
    - **Acceptance:** Test passes; returns None when current version >= latest
    - **Dependencies:** 7.2
    - **PRD Reference:** FR-23
  - [ ] 7.15 Run all update_checker tests with `cd backend && cargo test test_update_checker`
    - **Priority:** High
    - **Acceptance:** All tests pass; 100% pass rate
    - **Dependencies:** 7.3-7.14
    - **PRD Reference:** FR-23
  - [ ] 7.16 Verify full build with `make build -B`
    - **Priority:** High
    - **Acceptance:** No compilation errors; no qmllint errors
    - **Dependencies:** All previous tasks
    - **PRD Reference:** FR-22
  - [ ] 7.17 Test automatic update check on startup (with network)
    - **Priority:** High
    - **Acceptance:** Update check runs 500ms after window open; appropriate dialog shown if update available
    - **Dependencies:** 7.16
    - **PRD Reference:** SM-1, SM-2
  - [ ] 7.18 Test automatic update check on startup (without network)
    - **Priority:** High
    - **Acceptance:** Check fails silently; no error dialog; app continues normally
    - **Dependencies:** 7.16
    - **PRD Reference:** Error Handling
  - [ ] 7.19 Test "Check for Simsapa Updates..." menu item shows "no updates" when up to date
    - **Priority:** High
    - **Acceptance:** Dialog shows "Simsapa application and database are up to date."
    - **Dependencies:** 7.16
    - **PRD Reference:** FR-17
  - [ ] 7.20 Test "Notify About Simsapa Updates" toggle persists across sessions
    - **Priority:** High
    - **Acceptance:** Setting value preserved after app restart
    - **Dependencies:** 7.16
    - **PRD Reference:** SM-4
  - [ ] 7.21 Test multiple windows don't trigger duplicate update checks
    - **Priority:** High
    - **Acceptance:** Opening second SuttaSearchWindow does not trigger second update check
    - **Dependencies:** 7.16
    - **PRD Reference:** SM-5
  - [ ] 7.22 Test update check completes within 30 seconds
    - **Priority:** Medium
    - **Acceptance:** Check completes or times out within 30 seconds; no hang
    - **Dependencies:** 7.16
    - **PRD Reference:** SM-1
  - [ ] 7.23 Run full test suite with `make test`
    - **Priority:** High
    - **Acceptance:** All tests pass; no regressions
    - **Dependencies:** 7.15-7.22
    - **PRD Reference:** Phase 6
