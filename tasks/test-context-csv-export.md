# Manual Integration Test: CSV Export with Context Snippets

## Test Date: 2025-10-06

## Objective
Verify that the Anki CSV export includes two-paragraph Front field format with context snippets.

## Prerequisites
- Backend changes complete: `extract_words_with_context()` provides `context_snippet`
- Bridge updates complete: Uses `context_snippet` for `example_sentence`
- QML updates complete: CSV export functions use `example_sentence` in Front field
- Build successful

## Test Procedure

### 1. Launch Application
```bash
cd /home/gambhiro/prods/apps/simsapa-ng-project/simsapa-ng
./build/simsapadhammareader/simsapadhammareader
```

### 2. Open Gloss Tab
- Navigate to the Gloss tab in the application

### 3. Enter Test Pāli Text
Use the following test passage (from MN 10 Satipaṭṭhāna Sutta):

```
Katamañca, bhikkhave, samādhindriyaṁ? Idha, bhikkhave, ariyasāvako vossaggārammaṇaṁ karitvā labhati samādhiṁ, labhati cittassa ekaggataṁ.
```

### 4. Generate Glosses
- Click "Update All Glosses" button
- Wait for processing to complete
- Verify vocabulary words appear with context

### 5. Test All Paragraphs CSV Export
- Click "Export As..." dropdown
- Select "Anki CSV"
- Choose export folder
- Open exported CSV file

### 6. Verify CSV Format
Each row should have format:
```
Front,Back
word_stem

context_snippet,"definition"
```

Example expected output:
```
samādhindriyaṁ

Katamañca, bhikkhave, <b>samādhindriyaṁ</b>?,"concentration faculty; literally making strong concentration; [samādhi + indriya]"
```

### 7. Test Single Paragraph CSV Export
- Click "Copy As..." dropdown for a paragraph
- Select "Anki CSV"
- Verify clipboard contains same format

### 8. Verify Context Quality
Check that:
- Context snippets are sentence-based (not full paragraph)
- Bold tags `<b>word</b>` surround the target word
- Context is limited to reasonable length (~50 chars each side)
- Pāli diacritics are preserved (ā, ī, ū, ṁ, ṅ, ñ, ṭ, ḍ, ṇ, ḷ)

## Expected Results

✓ CSV exports successfully
✓ Front field has two paragraphs: stem and context
✓ Context snippet contains bold-wrapped target word
✓ Back field contains dictionary definition
✓ Proper CSV escaping for quotes and commas
✓ Diacritics preserved throughout

## Actual Results
(To be filled during manual testing)

## Issues Found
(To be documented during testing)

## Notes
- Context snippets are generated by `extract_words_with_context()` in backend
- HTML bold tags are intentional for Anki import
- Newlines between stem and context use `\n\n` separator
