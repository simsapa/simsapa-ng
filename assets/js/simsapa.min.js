(()=>{"use strict";var t=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,a)}c((i=i.apply(t,e||[])).next())})};const e=new class{constructor(){this.overlay=null,this.message_element=null,this.confirm_button=null,this.cancel_button=null,this.copy_button=null,this.current_url="",this.resolve_callback=null,this.initialized=!1,this.handlers_bound=!1}init(){const t=document.getElementById("confirmModalOverlay"),e=document.getElementById("confirmModalMessage"),n=document.getElementById("confirmModalConfirm"),i=document.getElementById("confirmModalCancel"),s=document.getElementById("confirmModalCopy");if(!(t&&e&&n&&i&&s))return console.error("[ConfirmModal] Required elements not found in DOM"),void(this.initialized=!1);this.overlay===t&&this.confirm_button===n&&this.cancel_button===i&&this.copy_button===s&&this.initialized||(this.overlay=t,this.message_element=e,this.confirm_button=n,this.cancel_button=i,this.copy_button=s,this.confirm_button.addEventListener("click",()=>this.handle_confirm()),this.cancel_button.addEventListener("click",()=>this.handle_cancel()),this.copy_button.addEventListener("click",()=>this.handle_copy()),this.overlay.addEventListener("click",t=>this.handle_overlay_click(t)),this.handlers_bound||(document.addEventListener("keydown",t=>this.handle_keydown(t)),this.handlers_bound=!0),this.initialized=!0)}show(t,e){return this.init(),this.overlay&&this.message_element?(this.current_url=e,this.message_element.textContent=t,this.overlay.classList.add("show"),new Promise(t=>{this.resolve_callback=e=>{t(e.confirmed)}})):(console.error("[ConfirmModal] Modal not initialized"),Promise.resolve(!1))}handle_confirm(){this.close(!0)}handle_cancel(){this.close(!1)}handle_copy(){return t(this,void 0,void 0,function*(){if(this.current_url)try{const t=globalThis.API_URL||"http://localhost:4848",e=yield fetch(`${t}/copy_to_clipboard`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:this.current_url})});e.ok?this.show_copy_feedback(!0):(console.error("[ConfirmModal] Copy failed with status:",e.status),this.show_copy_feedback(!1))}catch(t){console.error("[ConfirmModal] Failed to copy URL:",t),this.show_copy_feedback(!1)}else console.error("[ConfirmModal] No URL to copy")})}show_copy_feedback(t){if(!this.copy_button)return;const e=this.copy_button.textContent;this.copy_button.textContent=t?"Copied!":"Copy Failed",this.copy_button.classList.add(t?"success":"error"),setTimeout(()=>{this.copy_button&&(this.copy_button.textContent=e,this.copy_button.classList.remove("success","error"))},2e3)}handle_overlay_click(t){t.target===this.overlay&&this.close(!1)}handle_keydown(t){var e;"Escape"===t.key&&(null===(e=this.overlay)||void 0===e?void 0:e.classList.contains("show"))&&this.close(!1)}close(t){this.overlay&&(this.overlay.classList.remove("show"),this.resolve_callback&&(this.resolve_callback({confirmed:t}),this.resolve_callback=null))}};function n(n){return t(this,void 0,void 0,function*(){const t=`Open this link in your web browser?\n\n${n}`;return e.show(t,n)})}var i=function(t,e,n,i){return new(n||(n=Promise))(function(s,o){function r(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(r,a)}c((i=i.apply(t,e||[])).next())})};const s=/\b(DN|MN|SN|AN|Pv|Vv|Vism|iti|kp|khp|snp|th|thag|thig|ud|uda|dhp)[ .]*(\d[\d.:]*)\b/i;function o(t,e){return i(this,void 0,void 0,function*(){const n=globalThis.API_URL||"http://localhost:4848",i=yield fetch(`${n}/logger`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({log_level:e,msg:t})});if(!i.ok)throw new Error(`HTTP error! status: ${i.status} ${i.statusText}`)})}function r(t){return i(this,void 0,void 0,function*(){console.log(t),o(t,"info")})}function a(t){return i(this,void 0,void 0,function*(){console.error(t),o(t,"error")})}function c(t){return i(this,void 0,void 0,function*(){const e=globalThis.API_URL||"http://localhost:4848";try{const n=yield fetch(`${e}/open_external_url`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:t})});n.ok||a(`Failed to open external URL: ${n.status}`)}catch(t){a(`Error opening external URL: ${t instanceof Error?t.message:String(t)}`)}})}function l(t){const e=t.getAttribute("href")||"",n=t.textContent||"";if(e.startsWith("ssp://")){const t=e.match(/^ssp:\/\/suttas\/(.+)$/);if(t)return t[1]}if(e.includes("suttacentral.net")){const t=e.match(/suttacentral\.net\/(.+)$/);if(t)return t[1]}if(e.includes("thebuddhaswords.net")){const t=e.match(/\/suttas\/([^.]+)\.html/);if(t)return`${t[1]}/pli/ms`}const i=n.replace(/:/g,".").match(s);return i?`${i[1].toLowerCase()}${i[2]}/pli/ms`:null}function h(t){return i(this,void 0,void 0,function*(){const e=t.target;let s=null;if(s="A"===e.tagName?e:e.closest("a"),!s)return;const o=s.getAttribute("href")||"";if(o.startsWith("#"))return;const h=l(s);if(h)return t.preventDefault(),void(yield function(t,e){return i(this,void 0,void 0,function*(){const s=window,o=s.API_URL||globalThis.API_URL||"http://localhost:4848",l=s.WINDOW_ID||globalThis.WINDOW_ID;if(!l||""===l)return yield a(`WINDOW_ID not defined, falling back to open_sutta_by_uid for uid='${t}'`),void(yield function(t,e){return i(this,void 0,void 0,function*(){const i=globalThis.API_URL||"http://localhost:4848";try{const s=`${i}/open_sutta_window/${t}`,o=yield fetch(s);if(404===o.status){a(`Sutta not found: ${t}`);let i=`Sutta not found in database: ${t}`;e?(i+=`\n\nOriginal URL: ${e}\n\nWould you like to open this link in your web browser?`,(yield n(e))&&window.open(e,"_blank")):alert(i)}else o.ok?r(`Successfully opened sutta ${t}`):a(`Failed to open sutta ${t}: ${o.status}`)}catch(e){const n=e instanceof Error?e.message:String(e);a(`Error opening sutta ${t}: ${n}`)}})}(t,e));yield r(`open_sutta_in_tab: WINDOW_ID='${l}', uid='${t}'`);try{const i=`${o}/open_sutta_tab/${l}/${t}`,s=yield fetch(i);if(404===s.status){a(`Sutta not found: ${t}`);let i=`Sutta not found in database: ${t}`;e?(i+=`\n\nOriginal URL: ${e}\n\nWould you like to open this link in your web browser?`,(yield n(e))&&(yield c(e))):alert(i)}else s.ok||a(`Failed to open sutta ${t}: ${s.status}`)}catch(e){const n=e instanceof Error?e.message:String(e);a(`Error opening sutta ${t}: ${n}`)}})}(h,o));if(o.startsWith("/book_pages/")){const e=window.location.pathname,n=o.split("#")[0];return n!==e.split("#")[0]&&""!==n?(t.preventDefault(),void(yield function(t){return i(this,void 0,void 0,function*(){const e=window,n=e.API_URL||globalThis.API_URL||"http://localhost:4848",i=e.WINDOW_ID||globalThis.WINDOW_ID;if(!i||""===i)return yield r(`WINDOW_ID not defined, navigating to book page: ${t}`),void(window.location.href=t);yield r(`open_book_page_in_tab: WINDOW_ID='${i}', url='${t}'`);try{const e=`${n}/open_book_page_tab/${i}`,s=yield fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({book_page_url:t})});s.ok||(yield a(`Failed to open book page ${t}: ${s.status}`))}catch(e){const n=e instanceof Error?e.message:String(e);yield a(`Error opening book page ${t}: ${n}`)}})}(o))):void 0}return o.startsWith("http://")||o.startsWith("https://")?(t.preventDefault(),void((yield n(o))&&(yield c(o)))):void 0})}var d=function(){return d=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var s in e=arguments[n])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t},d.apply(this,arguments)};function u(t){return Object.freeze(t.reduce(function(t,e){var n;return Object.assign(t,((n={})[e.toLocaleLowerCase()]=!0,n))},{}))}u(["base","head","link","meta","style","title"]);var f=u(["address","article","aside","footer","header","h1","h2","h3","h4","h5","h6","hgroup","main","nav","section"]),p=u(["blockquote","dd","dir","div","dl","dt","figcaption","figure","hr","li","main","ol","p","pre","ul"]),m=u(["a","abbr","b","bdi","bdo","br","cite","code","data","dfn","em","i","kbd","mark","q","rb","rt","rtc","ruby","s","samp","small","span","strong","sub","sup","time","tt","u","var","wbr"]),v=u(["area","audio","img","map","track","video"]),g=u(["applet","embed","iframe","noembed","object","param","picture","source"]),y=(u(["canvas","noscript","script"]),u(["del","ins"]),u(["caption","col","colgroup","table","tbody","td","tfoot","th","thead","tr"])),b=u(["button","datalist","fieldset","form","input","label","legend","meter","optgroup","option","output","progress","select","textarea"]),_=(u(["details","dialog","menu","menuitem","summary"]),u(["acronym","applet","basefont","bgsound","big","blink","center","command","content","dir","element","font","frame","frameset","image","isindex","keygen","listing","marquee","menuitem","multicol","nextid","nobr","noembed","noframes","plaintext","shadow","spacer","strike","tt","xmp"]),u(["br","img","col","hr"])),k=d(d(d(d(d(d(d({},f),p),v),g),y),b),_);function E(t){return!!t&&t.nodeType===Node.ELEMENT_NODE}function w(t){return!!t&&t.nodeType===Node.TEXT_NODE}function x(t){return E(t)&&!!k[t.tagName.toLocaleLowerCase()]}function C(t){return E(t)&&(function(t){return E(t)&&!!_[t.tagName.toLocaleLowerCase()]}(t)||-1!==["SVG"].indexOf(t.tagName.toUpperCase()))}d(d({},m),{br:void 0,code:void 0});var I=function(){function t(t,e){this.foundText=e||"",this.text=t,this.range={start:0,end:0},this.replaceFunction=function(t){return document.createTextNode(t)}}return t.prototype.replace=function(){var t=this.range,e=t.start,n=t.end;if(e===n)return null;var i=this.text.slice(e,n);return this.replaceFunction(i,this.foundText)},t}(),L=function(){function t(t){this.next=null,this.replacements=[],this.replacedNodes=[],this.textNode=t}return t.prototype.addReplacement=function(t){if(0===this.replacements.length){if(t.range.start>0){var e=new I(this.textNode.nodeValue);e.range={start:0,end:t.range.start},this.replacements.push(e)}}else{var n=this.replacements[this.replacements.length-1];if(t.range.start-n.range.end>0){var i=new I(this.textNode.nodeValue);i.range={start:n.range.end,end:t.range.start},this.replacements.push(i)}else if(t.range.start-n.range.end<0)throw"Can't add replacement if replacement.range.start is less than last added replacement.range.end"}this.replacements.push(t)},t.prototype.replace=function(){var t=this.replacements[this.replacements.length-1],e=[];if(t.range.end<this.textNode.nodeValue.length){var n=new I(this.textNode.nodeValue);n.range={start:t.range.end,end:this.textNode.nodeValue.length},e.push(n)}var i=this.replacements.concat(e).reduce(function(t,e){var n=e.replace();return n?(t.push(n),t):t},[]);this.replacedNodes=i,this.textNode.parentNode&&this.textNode.parentNode.replaceChild(i.reduce(function(t,e){return t.appendChild(e),t},document.createDocumentFragment()),this.textNode)},t.prototype.recover=function(){for(var t=!1,e=0;e<this.replacedNodes.length;e++){var n=this.replacedNodes[e];try{var i=n.parentNode;if(!i)continue;t?i.removeChild(n):(i.replaceChild(this.textNode,n),t=!0)}catch(t){console.error("You might have changed dom node so that we can't recover")}}},t}(),S=function(){function t(){this.head=null,this.tail=null}return t.prototype.add=function(t){this.head?this.head!==t&&this.tail&&(this.tail.next=t,this.tail=t):this.head=this.tail=t},t}(),N=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,s,o=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)r.push(i.value)}catch(t){s={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(s)throw s.error}}return r};function B(t,e){var n=e.flag,i=e.find,s=e.replace,o=function(t){var e=[],n=[],i=[];if(!t.firstChild||!x(t))return i;e.push({node:t.firstChild,parentBlock:t});var s=t;for(i.push([]);e.length>0;){var o=e.pop(),r=o.node,a=o.parentBlock,c=r.firstChild,l=r.nextSibling,h=r.parentNode;s!==a&&0!==i[i.length-1].length&&i.push([]),s=a,w(r)?i[i.length-1].push(r):C(r)&&0!==i[i.length-1].length&&i.push([]),c?(e.push({node:c,parentBlock:x(r)?r:a}),l&&n.push({node:l,parentBlock:x(h)?h:a})):l?e.push({node:l,parentBlock:x(h)?h:a}):n.length>0&&e.push(n.pop())}return i}(t),r=o.map(function(t){var e=function(t){for(var e=[],n="",i=0;i<t.length;i++){var s=t[i];e.push({textNode:s,text:s.nodeValue,range:{start:n.length,end:n.length+s.nodeValue.length}}),n="".concat(n).concat(s.nodeValue)}return{text:n,ranges:e}}(t),o=e.text,r=e.ranges,a=new RegExp(i,n),c=new Map,l=new S,h=a.exec(o);if(!h)return null;for(;h&&h[0];){for(var d=h.index,u=N(h,1)[0],f=d+u.length,p="string"==typeof s?s:"",m="string"==typeof s?u:"",v="",g=0;g<r.length;g++){var y=r[g],b=y.textNode,_=y.text,k=y.range,E=k.start,w=k.end;if(!(E>f||w<d)){var x=new I(_,u);if(x.range={start:Math.max(E,d)-E,end:Math.min(w,f)-E},"string"==typeof s){var C=x.range;v=p.slice(0,C.end-C.start),p=p.slice(C.end-C.start),!(m=m.slice(C.end-C.start))&&p.length>0&&(v="".concat(v).concat(p),p=""),x.replaceFunction=function(t){return function(){return document.createTextNode(t)}}(v)}else x.replaceFunction=s;var B=c.get(b);B||(B=new L(b),l.add(B),c.set(b,B)),B.addReplacement(x)}}h=a.exec(o)}c.clear();for(var T=l.head;T;)T.replace(),T=T.next;return function(){for(var t=null==l?void 0:l.head;t;)t.recover(),t=t.next;l=null}});return function(){return r.forEach(function(t){null==t||t()})}}function T(){return window.SimsapaFindState||(window.SimsapaFindState=new Map),window.SimsapaFindState}const $=new class{constructor(){this.searchTerm="",this.currentMatchIndex=0,this.totalMatches=0,this.isVisible=!1,this.recoverFunction=null,this.debounceTimer=null,this.searchButton=null,this.findBar=null,this.findInput=null,this.findCounter=null,this.findError=null,this.prevButton=null,this.nextButton=null,this.accentFoldCheckbox=null,this.caseSensitiveCheckbox=null,this.contentArea=null,this.initializeElements()}initializeElements(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.bindElements()):this.bindElements()}bindElements(){this.searchButton=document.getElementById("findSearchButton"),this.findBar=document.getElementById("findBar"),this.findInput=document.getElementById("findInput"),this.findCounter=document.getElementById("findCounter"),this.findError=document.getElementById("findError"),this.prevButton=document.getElementById("findPrevButton"),this.nextButton=document.getElementById("findNextButton"),this.accentFoldCheckbox=document.getElementById("findAccentFold"),this.caseSensitiveCheckbox=document.getElementById("findCaseSensitive"),this.contentArea=document.getElementById("ssp_content"),this.setupEventListeners(),this.loadPreferences()}setupEventListeners(){this.searchButton&&this.searchButton.addEventListener("click",()=>this.toggle()),this.findInput&&(this.findInput.addEventListener("input",t=>{const e=t.target;this.debouncedSearch(e.value)}),this.findInput.addEventListener("keydown",t=>this.handleInputKeydown(t))),this.nextButton&&this.nextButton.addEventListener("click",()=>this.nextMatch()),this.prevButton&&this.prevButton.addEventListener("click",()=>this.previousMatch()),this.accentFoldCheckbox&&this.accentFoldCheckbox.addEventListener("change",()=>{this.searchTerm&&this.search(this.searchTerm),this.savePreferences()}),this.caseSensitiveCheckbox&&this.caseSensitiveCheckbox.addEventListener("change",()=>{this.searchTerm&&this.search(this.searchTerm),this.savePreferences()}),document.addEventListener("keydown",t=>this.handleGlobalKeydown(t))}handleInputKeydown(t){"Enter"===t.key?t.shiftKey?(t.preventDefault(),this.previousMatch()):(t.preventDefault(),this.nextMatch()):"Escape"===t.key&&(t.preventDefault(),this.hide())}handleGlobalKeydown(t){return t.ctrlKey&&"f"===t.key?(t.preventDefault(),void this.show()):"Escape"===t.key&&this.isVisible?(t.preventDefault(),void this.hide()):void 0}loadPreferences(){const t=T(),e=t.get("simsapa-find-term");e&&this.findInput&&(this.findInput.value=e);const n=t.get("simsapa-find-accent-fold");this.accentFoldCheckbox&&(this.accentFoldCheckbox.checked=!1!==n);const i=t.get("simsapa-find-case-sensitive");this.caseSensitiveCheckbox&&(this.caseSensitiveCheckbox.checked=!0===i)}savePreferences(){const t=T();this.findInput&&t.set("simsapa-find-term",this.findInput.value),this.accentFoldCheckbox&&t.set("simsapa-find-accent-fold",this.accentFoldCheckbox.checked),this.caseSensitiveCheckbox&&t.set("simsapa-find-case-sensitive",this.caseSensitiveCheckbox.checked)}debouncedSearch(t){null!==this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{this.search(t),this.savePreferences()},400)}show(){this.findBar&&this.searchButton&&(this.isVisible=!0,this.searchButton.classList.add("active"),this.findBar.classList.add("show"),setTimeout(()=>{this.findInput&&(this.findInput.focus(),this.findInput.select(),this.findInput.value&&this.findInput.value.length>=2&&this.search(this.findInput.value))},100))}hide(){this.findBar&&this.searchButton&&(this.isVisible=!1,this.searchButton.classList.remove("active"),this.findBar.classList.remove("show"),this.clearHighlights(),this.clearError())}clearHighlights(){this.recoverFunction&&(this.recoverFunction(),this.recoverFunction=null),this.updateCounter(0,0)}clearError(){this.findError&&(this.findError.classList.remove("show"),this.findError.textContent="")}updateCounter(t,e){this.findCounter&&(this.findCounter.textContent=`${t}/${e}`),this.currentMatchIndex=t,this.totalMatches=e}search(t){if(this.clearHighlights(),this.clearError(),t&&!(t.length<2)&&this.contentArea){this.searchTerm=t;try{this.recoverFunction=this.performSearch(t),this.updateMatchNavigation()}catch(t){this.showError("Invalid search pattern")}}}performSearch(t){if(!this.contentArea)return null;let e="g";this.isCaseSensitive()||(e+="i");const n=this.isAccentFoldingEnabled()?this.createAccentFoldedPattern(t):t,i=(o=this.contentArea,r={find:n,flag:e,replace:(t,e)=>{const n=document.createElement("span");return n.className="ssp-find-highlight",n.textContent=t,n}},a=Object.assign({},{flag:"g"},r),"string"==typeof o?function(t,e){var n=document.createElement("div");return n.innerHTML=t,B(n,e),n.innerHTML}(o,a):E(o)?B(o,a):null),s=this.contentArea.querySelectorAll(".ssp-find-highlight");var o,r,a;return this.updateCounter(s.length>0?1:0,s.length),0===s.length?(this.showError("No matches found"),i):(s.length>1e3&&this.showError(`Too many matches (${s.length}). Results limited to improve performance.`),s[0].classList.add("current"),this.scrollToElement(s[0]),i)}createAccentFoldedPattern(t){if(!this.isAccentFoldingEnabled())return t;const e=["ā","ī","ū","ṃ","ṁ","ṅ","ñ","ṭ","ḍ","ṇ","ḷ","ṛ","ṣ","ś"],n=["a","i","u","m","m","n","n","t","d","n","l","r","s","s"],i=new Map;for(let t=0;t<e.length;t++){const s=n[t],o=e[t];i.has(s)||i.set(s,new Set([s])),i.get(s).add(o)}const s=new Map;for(const[t,e]of i){const n=`[${Array.from(e).join("")}]`;s.set(t,n);for(const i of e)i!==t&&s.set(i,n)}let o="";for(const e of t)o+=s.get(e)||e;return o}isAccentFoldingEnabled(){return!this.accentFoldCheckbox||this.accentFoldCheckbox.checked}isCaseSensitive(){return!!this.caseSensitiveCheckbox&&this.caseSensitiveCheckbox.checked}updateMatchNavigation(){if(!this.prevButton||!this.nextButton)return;const t=this.totalMatches>0;this.prevButton.style.opacity=t?"1":"0.5",this.nextButton.style.opacity=t?"1":"0.5"}scrollToElement(t){t.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}showError(t){this.findError&&(this.findError.textContent=t,this.findError.classList.add("show"))}nextMatch(){if(!this.contentArea||0===this.totalMatches)return;const t=this.contentArea.querySelectorAll(".ssp-find-highlight");if(0===t.length)return;t.forEach(t=>t.classList.remove("current"));let e=this.currentMatchIndex%this.totalMatches;t[e].classList.add("current"),this.updateCounter(e+1,this.totalMatches),this.scrollToElement(t[e])}previousMatch(){if(!this.contentArea||0===this.totalMatches)return;const t=this.contentArea.querySelectorAll(".ssp-find-highlight");if(0===t.length)return;t.forEach(t=>t.classList.remove("current"));let e=this.currentMatchIndex-2;e<0&&(e=this.totalMatches-1),t[e].classList.add("current"),this.updateCounter(e+1,this.totalMatches),this.scrollToElement(t[e])}toggle(){this.isVisible?this.hide():this.show()}isShown(){return this.isVisible}setSearchTerm(t){this.findInput&&(this.findInput.value=t,this.show(),t&&t.length>=2&&(this.search(t),this.savePreferences()))}};function M(){r("[simsapa] Attaching link handlers");const t=document.getElementById("ssp_content");t?t.querySelectorAll("a").forEach(t=>{l(t)&&t.classList.add("sutta-link"),t.addEventListener("click",h)}):document.querySelectorAll("a").forEach(t=>{l(t)&&t.classList.add("sutta-link"),t.addEventListener("click",h)})}document.SSP={show_transient_message:function(t,e){const n=document.createElement("div");n.className="message";const i=document.createElement("div");i.className="msg-content",i.textContent=t,n.appendChild(i);let s=document.getElementById(e);s?(s.appendChild(n),n.style.transition="opacity 1.5s ease-in-out",n.style.opacity="1",setTimeout(()=>{n.style.opacity="0"},1e3),n.addEventListener("transitionend",()=>{n.remove()})):console.error("Cannot find: transient-messages")},find:$,attach_link_handlers:M},document.addEventListener("DOMContentLoaded",()=>{r("[simsapa] DOMContentLoaded event fired"),M()})})();